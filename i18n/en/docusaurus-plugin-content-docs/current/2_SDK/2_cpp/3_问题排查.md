---
id: cpp_problem
title: 注意事项与问题排查
sidebar_label: 注意事项与问题排查
description: 本文档说明介绍C++错误码和异常说明
---

# 问题排查
## 1 与RobotAssist同时使用

目前如果使用 xCore SDK 控制机器人，并不会限制通过 RobotAssist 的控制。机器人的一些状态，通过 xCore SDK 更改后也会体现在 Robot Assist 界面上；一些工程运行，运动控制则是分离的。大致总结如下：
| 分类 | 实现 |
| --- | --- |
| 会同步更新的组件 | - 底部状态栏：手自动，机器人状态，上下电；<br /> - 状态监控窗口；<br /> - 日志上报； |
| 双方可控，即通过 RobotAssist 修改会生效的组件 | - RL 工程运行速率和循环／单次模式；<br /> - 非实时模式运动的暂停；<br /> - 工具工件组：更改 RobotAssist 右上角选择的工具工件会改变 toolset；通过 setToolset 设置了工具工件，右上角会显示 “toolx ”，“wobjx ”  |
| 不会同步更新的组件，包括但不限于 | - 下发的运动指令无法通过点击开始按钮让机器人开始执行；<br /> - 加载的 RL 工程，以及前瞻指针、运动指针等，不会同步显示；<br /> - 大部分机器人设置界面显示的功能打开状态和设定值等； |


建议的控制方式是单一控制源，避免混淆。

## 2 兼容RCI客户端

对于原 RCI 客户端的用户，可以在控制器升级到 v3.0.1（v1.7及之后的版本也同样可以）之后直接使用 xCoreSDK。

### 2.1 首次使用

1．确保RobotAssist-通信-RCI设置是关闭的状态，也可通过状态栏中间的机器人状态确认；

2．调用 setMotionControlMode（RtCommand）接口来打开 RCI 功能，若打开成功，机器人状态变为 RCI，状态栏的图标也显示 RCI

3．之后就可通过上述接口或 RobotAssist 打开关闭 RCI 功能。需要注意的是，如果进行了抹除配置操作，那么同样视为首次使用，需要再通过 SDK 的接口打开 RCI。

### 2.2 切换到使用RCI客户端

在用过 SDK 后，RCI 客户端就无法同时使用了。如果想切换回去，需调用 useRciClient(true)，调用前按照函数说明，确保 RCI 是关闭的状态。然后再通过 RobotAssist 打开关闭 RCI 功能。

## 3 实时指令

用户下发的运动指令需要满足建议条件和必要条件。建议条件是为了让机器人运动更加平稳，性能最优。必要条件则是必须满足的，若不满足，机器人将会停止。

### 3.1 轴空间运动

#### 1．必要条件

轴空间轨迹平滑，至少保证速度是连续可导的：
$$
\begin{aligned}q_{\min} &< q_c < q_{\max} \\-\dot{q}_{\max} &< \dot{q}_c < \dot{q}_{\max} \\-\ddot{q}_{\max} &< \ddot{q}_c < \ddot{q}_{\max} \\-\dddot{q}_{\max} &< \dddot{q}_c < \dddot{q}_{\max}\\\end{aligned}
$$

#### 2．建议条件

力矩指令不超限：

$$
\begin{aligned}-\tau_{j\text{max}} &< \tau_{jc} < \tau_{j\text{max}} \\-\dot{\tau}_{j\text{max}} &< \dot{\tau}_{jc} < \dot{\tau}_{j\text{max}}\\\end{aligned}
$$

运动开始时：

$$
\begin{aligned}q &= q_c \\\dot{q}_c &= 0 \\\ddot{q}_c &= 0\\\end{aligned}
$$

运动结束时：

$$
\begin{aligned}\dot{q}_{c} &= 0 \\\ddot{q}_{c} &= 0\\\end{aligned}
$$

### 3.2 笛卡尔空间运动

#### 1．必要条件

不处于奇异位且在工作空间内：

$$
\begin{aligned}-\dot{p}_{\max } & <\dot{p}_{c}<\dot{p}_{\max } \\-\ddot{p}_{\max } & <\ddot{p}_{c}<\ddot{p}_{\max } \\-\dddot{p}_{\max } & <\dddot{p}_{c}<\dddot{p}_{\max }\\\end{aligned}
$$


#### 2．建议条件

力矩指令不超限：

$$
\begin{aligned}\\-\tau_{j\max} &< \tau_{jc} < \tau_{j\max} \\-\dot{\tau}_{j\max} &< \dot{\tau}_{jc} < \dot{\tau}_{j\max}\end{aligned}
$$


运动开始时：

$$
\begin{aligned}\\T &= T_c \\\dot{p}_c &= 0 \\\ddot{p}_c &= 0\\\end{aligned}
$$


运动结束时：

$$
\begin{aligned}\dot{\mathbf{p}}_{\mathrm{c}} &= 0 \\\ddot{\mathbf{p}}_{\mathrm{c}} &= 0\\\end{aligned}
$$

### 3.3 力矩直接控制

#### 1．必要条件

力矩指令不超限且连续：

$$
\begin{aligned}-\dot{\tau}_{j \max } & <\dot{\tau}_{j c}<\dot{\tau}_{j \max } \\-\tau_{j \max } & <\tau_{j c}<\tau_{j \max }\\\end{aligned}
$$

### 3.4 运动限制条件

xMateER3 Pro、xMateER7 Pro、xMateER3、xMateER7笛卡尔空间运动限制条件：


| 参数 | 平移 | 旋转 |
| --- | --- | --- |
| 速度 | $1.0 m/s$ | $2.5 rad/s$ |
| 加速度 | $10.0 m/s^2$ | $10.0 rad/s2$ |
| 加加速度 | $5000.0 m/s^3$ | $5000.0 rad/s^3$ |


xMateER3 Pro 和 xMateER7 Pro 轴空间运动限制条件：


| 参数 | 一轴 | 二轴 | 三轴 | 四轴 | 五轴 | 六轴 | 七轴 | 单位 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 限位上限 | 170  | 120  | 170  | 120  | 170  | 120  | 360  | °  |
| 限位下限 | -170  | -120  | -170  | -120  | -170  | -120  | -360  | °  |
| 速度上限 | 2.175  | 2.175  | 2.175  | 2.175  | 2.610  | 2.610  | 2.610  | $rad/s$ |
| 加速度上限 | 15  | 7.5  | 10  | 10  | 15  | 15  | 20  | $rad/s^2$ |
| 加加速度上限 | 5000  | 3500  | 5000  | 5000  | 7500  | 7500  | 7500  | $rad/s^3$ |


xMate3 和 xMate7 轴空间运动限制条件：


| 参数 | 一轴 | 二轴 | 三轴 | 四轴 | 五轴 | 六轴 | 单位 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 限位上限 | 170  | 120  | 120  | 170  | 120  | 360  | °   |
| 限位下限 | -170  | -120  | -120  | -170  | -120  | -360  | °   |
| 速度上限 | 2.175  | 2.175  | 2.175  | 2.610  | 2.610  | 2.610  | $rad/s$ |
| 加速度上限 | 15  | 7.5  | 10  | 15  | 15  | 20  | $rad/s^2$ |
| 加加速度上限 | 5000  | 3500  | 5000  | 7500  | 7500  | 7500  | $rad/s^3$ |



xMateER3 Pro 和 xMateER7 Pro 直接力矩控制限制条件


| 参数 | 一轴 | 二轴 | 三轴 | 四轴 | 五轴 | 六轴 | 七轴 | 单位 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 力矩上限 | 85  | 85  | 85  | 85  | 36  | 36  | 36  | $Nm$  |
| 力矩微分上限 | 1500  | 1500  | 1500  | 1500  | 1000  | 1000  | 1000  | $Nm/s$ |


xMate3 和 xMate7 直接力矩控制限制条件


| 参数 | 一轴 | 二轴 | 三轴 | 四轴 | 五轴 | 六轴 | 单位 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 力矩上限 | 85  | 85  | 85  | 36  | 36  | 36  | $Nm$  |
| 力矩微分上限 | 1500  | 1500  | 1500  | 1000  | 1000  | 1000  | $Nm/s$ |


### 5.3.5 DH参数

xMateER3 Pro DH 参数表：


| Joint  | A(mm)  | Alpha(rad)  | D(mm)  | Theta(rad)  |
| --- | --- | --- | --- | --- |
| 1  | 0  | -pi/2  | 341.5  | 0  |
| 2  | 0  | pi/2 | 0  | 0  |
| 3  | 0  | -pi/2 | 394.0  | 0  |
| 4  | 0  | pi/2 | 0  | 0  |
| 5  | 0  | -pi/2 | 366  | 0  |
| 6  | 0  | pi/2 | 0  | 0  |
| 7  | 0  | 0  | 250.3  | 0  |


xMateER7 Pro DH 参数表：


| Joint  | A(mm)  | Alpha(rad) | D(mm)  | Theta(rad)  |
| --- | --- | --- | --- | --- |
| 1  | 0  | -pi/2 | 404.0  | 0  |
| 2  | 0  | pi/2 | 0  | 0  |
| 3  | 0  | -pi/2 | 437.5  | 0  |
| 4  | 0  | pi/2 | 0  | 0  |
| 5  | 0  | -pi/2 | 412.5  | 0  |
| 6  | 0  | pi/2 | 0  | 0  |
| 7  | 0  | 0  | 275.5  | 0  |


xMate3 DH 参数表：


| Joint  | A(mm)  | Alpha(rad)  | D(mm)  | Theta(rad)  |
| --- | --- | --- | --- | --- |
| 1  | 0  | -pi/2 | 341.5  | 0  |
| 2  | 394  | 0  | 0  | 0  |
| 3  | 0  | pi/2 | 0  | 0  |
| 4  | 0  | -pi/2 | 366  | 0  |
| 5  | 0  | pi/2 | 0  | 0  |
| 6  | 0  | 0  | 250.3  | 0  |


xMate7 DH 参数表：


| Joint  | A(mm)  | Alpha(rad) | D(mm)  | Theta(rad)  |
| --- | --- | --- | --- | --- |
| 1  | 0  | -pi/2 | 404  | 0  |
| 2  | 437.5  | 0  | 0  | 0  |
| 3  | 0  | pi/2 | 0  | 0  |
| 4  | 0  | -pi/2 | 412.5  | 0  |
| 5  | 0  | pi/2 | 0  | 0  |
| 6  | 0  | 0  | 275.5  | 0  |


### 5.4问题排查

#### 5.4.1网络连接问题

实时运动指令和状态信息都通过 UDP 协议单播发送。如果出现“超时前未收到机器人状态反馈”的实时状态异常，Windows 系统请检查防火墙设置，UDP 入站规则是否是允许的状态。

Linux 系统（Debian 发行版）：打开终端，输入命令 `nc-vul-p1337` ，然后再任意运行一个实时模式控制的示例程序，查看是否有来自机器人地址的端口连接过来，并且收到了数据。



#### 5.4.2实时模式直接力矩控制下坠问题

力控和机器本身硬件状态有关系。如果出现开启直接力矩控制之后没有发送任何指令，但是机器人下坠或者发飘等问题，可能是由于力控模型不准的原因。首先需要确认每项力控参数是否准确；其次可以根据实机情况调整发送的运动指令。